import{u as y}from"./BgjWWMr1.js";import{d as z,r as v,J as o,u as b,o as p,M as A}from"./YKJGr53e.js";import{u as w,a as _,p as f,m as I,b as S}from"./BHB5aYOm.js";const P={...S,placeholder:{type:[Boolean,String,Number,Array],default:void 0},placeholderClass:{type:String,default:void 0}},k=z({name:"NuxtImg",props:P,emits:["load","error"],setup:(a,i)=>{const n=w(),r=_(a),u=v(!1),l=v(),s=o(()=>n.getSizes(a.src,{...r.options.value,sizes:a.sizes,densities:a.densities,modifiers:{...r.modifiers.value,width:f(a.width),height:f(a.height)}})),g=o(()=>{const e={...r.attrs.value,"data-nuxt-img":""};return(!a.placeholder||u.value)&&(e.sizes=s.value.sizes,e.srcset=s.value.srcset),e}),c=o(()=>{let e=a.placeholder;if(e===""&&(e=!0),!e||u.value)return!1;if(typeof e=="string")return e;const t=Array.isArray(e)?e:typeof e=="number"?[e,e]:[10,10];return n(a.src,{...r.modifiers.value,width:t[0],height:t[1],quality:t[2]||50,blur:t[3]||3},r.options.value)}),d=o(()=>a.sizes?s.value.src:n(a.src,r.modifiers.value,r.options.value)),m=o(()=>c.value?c.value:d.value);if(a.preload){const e=Object.values(s.value).every(t=>t);y({link:[{rel:"preload",as:"image",nonce:a.nonce,...e?{href:s.value.src,imagesizes:s.value.sizes,imagesrcset:s.value.srcset}:{href:m.value},...typeof a.preload!="boolean"&&a.preload.fetchPriority?{fetchpriority:a.preload.fetchPriority}:{}}]})}const h=b().isHydrating;return p(()=>{if(c.value){const e=new Image;e.src=d.value,a.sizes&&(e.sizes=s.value.sizes||"",e.srcset=s.value.srcset),e.onload=t=>{u.value=!0,i.emit("load",t)},I("nuxt-image");return}l.value&&(l.value.complete&&h&&(l.value.getAttribute("data-error")?i.emit("error",new Event("error")):i.emit("load",new Event("load"))),l.value.onload=e=>{i.emit("load",e)},l.value.onerror=e=>{i.emit("error",e)})}),()=>A("img",{ref:l,...g.value,...i.attrs,class:a.placeholder&&!u.value?[a.placeholderClass]:void 0,src:m.value})}});export{k as _};
