import Re from"./srjAdVVy.js";import{J as O,B as k,a5 as Ee,E as W,ac as ce,ad as Te,b as be,d as H,r as z,a6 as _e,z as B,L as ge,o as ue,M as le,F as xe,N as oe,P as Oe,O as N,ab as Me,l as ze,c as L,e as Q,f as j,A as $e,D as ve,w as ee,h as Z,C as De,n as U,t as te,g as Pe,S as ke}from"./YKJGr53e.js";import{u as fe}from"./j4F_aXRO.js";import{u as Ve}from"./CTAIbY_z.js";import{q as Ae}from"./CHZsaEkH.js";import{d as Fe,c as $,f as pe,e as Be,u as Le}from"./Be8J6HL0.js";import{o as re,t as me}from"./CBpMDLrE.js";import{u as q,o as I,w as je,t as Ne,i as ne,f as We,E as Ke,b as Ue,A as X,T as de,I as ie,g as qe,N as ae,l as He,O as Je,c as V,n as Ye}from"./BboEKukF.js";import{s as Ze}from"./BIqF7sE6.js";import{i as Ge}from"./BGcilHqP.js";function G(o,u,e){let n=e.initialDeps??[],t;return()=>{var i,a,l,d;let p;e.key&&((i=e.debug)!=null&&i.call(e))&&(p=Date.now());const v=o();if(!(v.length!==n.length||v.some((R,h)=>n[h]!==R)))return t;n=v;let S;if(e.key&&((a=e.debug)!=null&&a.call(e))&&(S=Date.now()),t=u(...v),e.key&&((l=e.debug)!=null&&l.call(e))){const R=Math.round((Date.now()-p)*100)/100,h=Math.round((Date.now()-S)*100)/100,M=h/16,D=(P,g)=>{for(P=String(P);P.length<g;)P=" "+P;return P};console.info(`%c⏱ ${D(h,5)} /${D(R,5)} ms`,`
            font-size: .6rem;
            font-weight: bold;
            color: hsl(${Math.max(0,Math.min(120-120*M,120))}deg 100% 31%);`,e==null?void 0:e.key)}return(d=e==null?void 0:e.onChange)==null||d.call(e,t),t}}function se(o,u){if(o===void 0)throw new Error("Unexpected undefined");return o}const Qe=(o,u)=>Math.abs(o-u)<1,Xe=(o,u,e)=>{let n;return function(...t){o.clearTimeout(n),n=o.setTimeout(()=>u.apply(this,t),e)}},et=o=>o,tt=o=>{const u=Math.max(o.startIndex-o.overscan,0),e=Math.min(o.endIndex+o.overscan,o.count-1),n=[];for(let t=u;t<=e;t++)n.push(t);return n},lt=(o,u)=>{const e=o.scrollElement;if(!e)return;const n=o.targetWindow;if(!n)return;const t=a=>{const{width:l,height:d}=a;u({width:Math.round(l),height:Math.round(d)})};if(t(e.getBoundingClientRect()),!n.ResizeObserver)return()=>{};const i=new n.ResizeObserver(a=>{const l=a[0];if(l!=null&&l.borderBoxSize){const d=l.borderBoxSize[0];if(d){t({width:d.inlineSize,height:d.blockSize});return}}t(e.getBoundingClientRect())});return i.observe(e,{box:"border-box"}),()=>{i.unobserve(e)}},he={passive:!0},ot=typeof window>"u"?!0:"onscrollend"in window,nt=(o,u)=>{const e=o.scrollElement;if(!e)return;const n=o.targetWindow;if(!n)return;let t=0;const i=ot?()=>{}:Xe(n,()=>{u(t,!1)},o.options.isScrollingResetDelay),a=p=>()=>{t=e[o.options.horizontal?"scrollLeft":"scrollTop"],i(),u(t,p)},l=a(!0),d=a(!1);return d(),e.addEventListener("scroll",l,he),e.addEventListener("scrollend",d,he),()=>{e.removeEventListener("scroll",l),e.removeEventListener("scrollend",d)}},at=(o,u,e)=>{if(u!=null&&u.borderBoxSize){const n=u.borderBoxSize[0];if(n)return Math.round(n[e.options.horizontal?"inlineSize":"blockSize"])}return Math.round(o.getBoundingClientRect()[e.options.horizontal?"width":"height"])},it=(o,{adjustments:u=0,behavior:e},n)=>{var t,i;const a=o+u;(i=(t=n.scrollElement)==null?void 0:t.scrollTo)==null||i.call(t,{[n.options.horizontal?"left":"top"]:a,behavior:e})};class st{constructor(u){this.unsubs=[],this.scrollElement=null,this.targetWindow=null,this.isScrolling=!1,this.scrollToIndexTimeoutId=null,this.measurementsCache=[],this.itemSizeCache=new Map,this.pendingMeasuredCacheIndexes=[],this.scrollDirection=null,this.scrollAdjustments=0,this.measureElementCache=new Map,this.observer=(()=>{let e=null;const n=()=>e||(!this.targetWindow||!this.targetWindow.ResizeObserver?null:e=new this.targetWindow.ResizeObserver(t=>{t.forEach(i=>{this._measureElement(i.target,i)})}));return{disconnect:()=>{var t;return(t=n())==null?void 0:t.disconnect()},observe:t=>{var i;return(i=n())==null?void 0:i.observe(t,{box:"border-box"})},unobserve:t=>{var i;return(i=n())==null?void 0:i.unobserve(t)}}})(),this.range=null,this.setOptions=e=>{Object.entries(e).forEach(([n,t])=>{typeof t>"u"&&delete e[n]}),this.options={debug:!1,initialOffset:0,overscan:1,paddingStart:0,paddingEnd:0,scrollPaddingStart:0,scrollPaddingEnd:0,horizontal:!1,getItemKey:et,rangeExtractor:tt,onChange:()=>{},measureElement:at,initialRect:{width:0,height:0},scrollMargin:0,gap:0,indexAttribute:"data-index",initialMeasurementsCache:[],lanes:1,isScrollingResetDelay:150,...e}},this.notify=(e,n)=>{var t,i;const{startIndex:a,endIndex:l}=this.range??{startIndex:void 0,endIndex:void 0},d=this.calculateRange();(e||a!==(d==null?void 0:d.startIndex)||l!==(d==null?void 0:d.endIndex))&&((i=(t=this.options).onChange)==null||i.call(t,this,n))},this.cleanup=()=>{this.unsubs.filter(Boolean).forEach(e=>e()),this.unsubs=[],this.scrollElement=null},this._didMount=()=>(this.measureElementCache.forEach(this.observer.observe),()=>{this.observer.disconnect(),this.cleanup()}),this._willUpdate=()=>{var e;const n=this.options.getScrollElement();this.scrollElement!==n&&(this.cleanup(),this.scrollElement=n,this.scrollElement&&"ownerDocument"in this.scrollElement?this.targetWindow=this.scrollElement.ownerDocument.defaultView:this.targetWindow=((e=this.scrollElement)==null?void 0:e.window)??null,this._scrollToOffset(this.scrollOffset,{adjustments:void 0,behavior:void 0}),this.unsubs.push(this.options.observeElementRect(this,t=>{this.scrollRect=t,this.notify(!1,!1)})),this.unsubs.push(this.options.observeElementOffset(this,(t,i)=>{this.scrollAdjustments=0,this.scrollDirection=i?this.scrollOffset<t?"forward":"backward":null,this.scrollOffset=t;const a=this.isScrolling;this.isScrolling=i,this.notify(a!==i,i)})))},this.getSize=()=>this.scrollRect[this.options.horizontal?"width":"height"],this.getMeasurementOptions=G(()=>[this.options.count,this.options.paddingStart,this.options.scrollMargin,this.options.getItemKey],(e,n,t,i)=>(this.pendingMeasuredCacheIndexes=[],{count:e,paddingStart:n,scrollMargin:t,getItemKey:i}),{key:!1}),this.getFurthestMeasurement=(e,n)=>{const t=new Map,i=new Map;for(let a=n-1;a>=0;a--){const l=e[a];if(t.has(l.lane))continue;const d=i.get(l.lane);if(d==null||l.end>d.end?i.set(l.lane,l):l.end<d.end&&t.set(l.lane,!0),t.size===this.options.lanes)break}return i.size===this.options.lanes?Array.from(i.values()).sort((a,l)=>a.end===l.end?a.index-l.index:a.end-l.end)[0]:void 0},this.getMeasurements=G(()=>[this.getMeasurementOptions(),this.itemSizeCache],({count:e,paddingStart:n,scrollMargin:t,getItemKey:i},a)=>{const l=this.pendingMeasuredCacheIndexes.length>0?Math.min(...this.pendingMeasuredCacheIndexes):0;this.pendingMeasuredCacheIndexes=[];const d=this.measurementsCache.slice(0,l);for(let p=l;p<e;p++){const v=i(p),m=this.options.lanes===1?d[p-1]:this.getFurthestMeasurement(d,p),S=m?m.end+this.options.gap:n+t,R=a.get(v),h=typeof R=="number"?R:this.options.estimateSize(p),M=S+h,D=m?m.lane:p%this.options.lanes;d[p]={index:p,start:S,size:h,end:M,key:v,lane:D}}return this.measurementsCache=d,d},{key:!1,debug:()=>this.options.debug}),this.calculateRange=G(()=>[this.getMeasurements(),this.getSize(),this.scrollOffset],(e,n,t)=>this.range=e.length>0&&n>0?rt({measurements:e,outerSize:n,scrollOffset:t}):null,{key:!1,debug:()=>this.options.debug}),this.getIndexes=G(()=>[this.options.rangeExtractor,this.calculateRange(),this.options.overscan,this.options.count],(e,n,t,i)=>n===null?[]:e({startIndex:n.startIndex,endIndex:n.endIndex,overscan:t,count:i}),{key:!1,debug:()=>this.options.debug}),this.indexFromElement=e=>{const n=this.options.indexAttribute,t=e.getAttribute(n);return t?parseInt(t,10):(console.warn(`Missing attribute name '${n}={index}' on measured element.`),-1)},this._measureElement=(e,n)=>{const t=this.measurementsCache[this.indexFromElement(e)];if(!t||!e.isConnected){this.measureElementCache.forEach((l,d)=>{l===e&&(this.observer.unobserve(e),this.measureElementCache.delete(d))});return}const i=this.measureElementCache.get(t.key);i!==e&&(i&&this.observer.unobserve(i),this.observer.observe(e),this.measureElementCache.set(t.key,e));const a=this.options.measureElement(e,n,this);this.resizeItem(t,a)},this.resizeItem=(e,n)=>{const t=this.itemSizeCache.get(e.key)??e.size,i=n-t;i!==0&&((this.shouldAdjustScrollPositionOnItemSizeChange!==void 0?this.shouldAdjustScrollPositionOnItemSizeChange(e,i,this):e.start<this.scrollOffset+this.scrollAdjustments)&&this._scrollToOffset(this.scrollOffset,{adjustments:this.scrollAdjustments+=i,behavior:void 0}),this.pendingMeasuredCacheIndexes.push(e.index),this.itemSizeCache=new Map(this.itemSizeCache.set(e.key,n)),this.notify(!0,!1))},this.measureElement=e=>{e&&this._measureElement(e,void 0)},this.getVirtualItems=G(()=>[this.getIndexes(),this.getMeasurements()],(e,n)=>{const t=[];for(let i=0,a=e.length;i<a;i++){const l=e[i],d=n[l];t.push(d)}return t},{key:!1,debug:()=>this.options.debug}),this.getVirtualItemForOffset=e=>{const n=this.getMeasurements();return se(n[ye(0,n.length-1,t=>se(n[t]).start,e)])},this.getOffsetForAlignment=(e,n)=>{const t=this.getSize();n==="auto"&&(e<=this.scrollOffset?n="start":e>=this.scrollOffset+t?n="end":n="start"),n==="start"?e=e:n==="end"?e=e-t:n==="center"&&(e=e-t/2);const i=this.options.horizontal?"scrollWidth":"scrollHeight",l=(this.scrollElement?"document"in this.scrollElement?this.scrollElement.document.documentElement[i]:this.scrollElement[i]:0)-this.getSize();return Math.max(Math.min(l,e),0)},this.getOffsetForIndex=(e,n="auto")=>{e=Math.max(0,Math.min(e,this.options.count-1));const t=se(this.getMeasurements()[e]);if(n==="auto")if(t.end>=this.scrollOffset+this.getSize()-this.options.scrollPaddingEnd)n="end";else if(t.start<=this.scrollOffset+this.options.scrollPaddingStart)n="start";else return[this.scrollOffset,n];const i=n==="end"?t.end+this.options.scrollPaddingEnd:t.start-this.options.scrollPaddingStart;return[this.getOffsetForAlignment(i,n),n]},this.isDynamicMode=()=>this.measureElementCache.size>0,this.cancelScrollToIndex=()=>{this.scrollToIndexTimeoutId!==null&&this.targetWindow&&(this.targetWindow.clearTimeout(this.scrollToIndexTimeoutId),this.scrollToIndexTimeoutId=null)},this.scrollToOffset=(e,{align:n="start",behavior:t}={})=>{this.cancelScrollToIndex(),t==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.getOffsetForAlignment(e,n),{adjustments:void 0,behavior:t})},this.scrollToIndex=(e,{align:n="auto",behavior:t}={})=>{e=Math.max(0,Math.min(e,this.options.count-1)),this.cancelScrollToIndex(),t==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size.");const[i,a]=this.getOffsetForIndex(e,n);this._scrollToOffset(i,{adjustments:void 0,behavior:t}),t!=="smooth"&&this.isDynamicMode()&&this.targetWindow&&(this.scrollToIndexTimeoutId=this.targetWindow.setTimeout(()=>{if(this.scrollToIndexTimeoutId=null,this.measureElementCache.has(this.options.getItemKey(e))){const[d]=this.getOffsetForIndex(e,a);Qe(d,this.scrollOffset)||this.scrollToIndex(e,{align:a,behavior:t})}else this.scrollToIndex(e,{align:a,behavior:t})}))},this.scrollBy=(e,{behavior:n}={})=>{this.cancelScrollToIndex(),n==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.scrollOffset+e,{adjustments:void 0,behavior:n})},this.getTotalSize=()=>{var e;const n=this.getMeasurements();let t;return n.length===0?t=this.options.paddingStart:t=this.options.lanes===1?((e=n[n.length-1])==null?void 0:e.end)??0:Math.max(...n.slice(-this.options.lanes).map(i=>i.end)),t-this.options.scrollMargin+this.options.paddingEnd},this._scrollToOffset=(e,{adjustments:n,behavior:t})=>{this.options.scrollToFn(e,{behavior:t,adjustments:n},this)},this.measure=()=>{var e,n;this.itemSizeCache=new Map,(n=(e=this.options).onChange)==null||n.call(e,this,!1)},this.setOptions(u),this.scrollRect=this.options.initialRect,this.scrollOffset=typeof this.options.initialOffset=="function"?this.options.initialOffset():this.options.initialOffset,this.measurementsCache=this.options.initialMeasurementsCache,this.measurementsCache.forEach(e=>{this.itemSizeCache.set(e.key,e.size)}),this.notify(!1,!1)}}const ye=(o,u,e,n)=>{for(;o<=u;){const t=(o+u)/2|0,i=e(t);if(i<n)o=t+1;else if(i>n)u=t-1;else return t}return o>0?o-1:0};function rt({measurements:o,outerSize:u,scrollOffset:e}){const n=o.length-1,i=ye(0,n,l=>o[l].start,e);let a=i;for(;a<n&&o[a].end<e+u;)a++;return{startIndex:i,endIndex:a}}function ut(o){const u=new st(k(o)),e=Ee(u),n=u._didMount();return W(()=>k(o).getScrollElement(),t=>{t&&u._willUpdate()},{immediate:!0}),W(()=>k(o),t=>{u.setOptions({...t,onChange:(i,a)=>{var l;ce(e),(l=t.onChange)==null||l.call(t,i,a)}}),u._willUpdate(),ce(e)},{immediate:!0}),Te(n),e}function dt(o){return ut(O(()=>({observeElementRect:lt,observeElementOffset:nt,scrollToFn:it,...k(o)})))}function ct(){let o=re();return be(()=>o.dispose()),o}function vt(){let o=ct();return u=>{o.dispose(),o.nextFrame(u)}}var Ie=(o=>(o[o.Left=0]="Left",o[o.Right=2]="Right",o))(Ie||{}),ft={};function pt(o,u){return o===u}var mt=(o=>(o[o.Open=0]="Open",o[o.Closed=1]="Closed",o))(mt||{}),ht=(o=>(o[o.Single=0]="Single",o[o.Multi=1]="Multi",o))(ht||{}),bt=(o=>(o[o.Pointer=0]="Pointer",o[o.Focus=1]="Focus",o[o.Other=2]="Other",o))(bt||{});let Se=Symbol("ComboboxContext");function J(o){let u=Oe(Se,null);if(u===null){let e=new Error(`<${o} /> is missing a parent <Combobox /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(e,J),e}return u}let we=Symbol("VirtualContext"),gt=H({name:"VirtualProvider",setup(o,{slots:u}){let e=J("VirtualProvider"),n=O(()=>{let l=I(e.optionsRef);if(!l)return{start:0,end:0};let d=window.getComputedStyle(l);return{start:parseFloat(d.paddingBlockStart||d.paddingTop),end:parseFloat(d.paddingBlockEnd||d.paddingBottom)}}),t=dt(O(()=>({scrollPaddingStart:n.value.start,scrollPaddingEnd:n.value.end,count:e.virtual.value.options.length,estimateSize(){return 40},getScrollElement(){return I(e.optionsRef)},overscan:12}))),i=O(()=>{var l;return(l=e.virtual.value)==null?void 0:l.options}),a=z(0);return W([i],()=>{a.value+=1}),ge(we,e.virtual.value?t:null),()=>[le("div",{style:{position:"relative",width:"100%",height:`${t.value.getTotalSize()}px`},ref:l=>{if(l){if(typeof process<"u"&&ft.JEST_WORKER_ID!==void 0||e.activationTrigger.value===0)return;e.activeOptionIndex.value!==null&&e.virtual.value.options.length>e.activeOptionIndex.value&&t.value.scrollToIndex(e.activeOptionIndex.value)}}},t.value.getVirtualItems().map(l=>Me(u.default({option:e.virtual.value.options[l.index],open:e.comboboxState.value===0})[0],{key:`${a.value}-${l.index}`,"data-index":l.index,"aria-setsize":e.virtual.value.options.length,"aria-posinset":l.index+1,style:{position:"absolute",top:0,left:0,transform:`translateY(${l.start}px)`,overflowAnchor:"none"}})))]}}),xt=H({name:"Combobox",emits:{"update:modelValue":o=>!0},props:{as:{type:[Object,String],default:"template"},disabled:{type:[Boolean],default:!1},by:{type:[String,Function],nullable:!0,default:null},modelValue:{type:[Object,String,Number,Boolean],default:void 0},defaultValue:{type:[Object,String,Number,Boolean],default:void 0},form:{type:String,optional:!0},name:{type:String,optional:!0},nullable:{type:Boolean,default:!1},multiple:{type:[Boolean],default:!1},immediate:{type:[Boolean],default:!1},virtual:{type:Object,default:null}},inheritAttrs:!1,setup(o,{slots:u,attrs:e,emit:n}){let t=z(1),i=z(null),a=z(null),l=z(null),d=z(null),p=z({static:!1,hold:!1}),v=z([]),m=z(null),S=z(2),R=z(!1);function h(s=c=>c){let c=m.value!==null?v.value[m.value]:null,b=s(v.value.slice()),x=b.length>0&&b[0].dataRef.order.value!==null?b.sort((_,F)=>_.dataRef.order.value-F.dataRef.order.value):Je(b,_=>I(_.dataRef.domRef)),T=c?x.indexOf(c):null;return T===-1&&(T=null),{options:x,activeOptionIndex:T}}let M=O(()=>o.multiple?1:0),D=O(()=>o.nullable),[P,g]=Fe(O(()=>o.modelValue),s=>n("update:modelValue",s),O(()=>o.defaultValue)),E=O(()=>P.value===void 0?q(M.value,{1:[],0:void 0}):P.value),A=null,f=null;function w(s){return q(M.value,{0(){return g==null?void 0:g(s)},1:()=>{let c=B(r.value.value).slice(),b=B(s),x=c.findIndex(T=>r.compare(b,B(T)));return x===-1?c.push(b):c.splice(x,1),g==null?void 0:g(c)}})}let C=O(()=>{});W([C],([s],[c])=>{if(r.virtual.value&&s&&c&&m.value!==null){let b=s.indexOf(c[m.value]);b!==-1?m.value=b:m.value=null}});let r={comboboxState:t,value:E,mode:M,compare(s,c){if(typeof o.by=="string"){let b=o.by;return(s==null?void 0:s[b])===(c==null?void 0:c[b])}return o.by===null?pt(s,c):o.by(s,c)},calculateIndex(s){return r.virtual.value?o.by===null?r.virtual.value.options.indexOf(s):r.virtual.value.options.findIndex(c=>r.compare(c,s)):v.value.findIndex(c=>r.compare(c.dataRef.value,s))},defaultValue:O(()=>o.defaultValue),nullable:D,immediate:O(()=>!1),virtual:O(()=>null),inputRef:a,labelRef:i,buttonRef:l,optionsRef:d,disabled:O(()=>o.disabled),options:v,change(s){g(s)},activeOptionIndex:O(()=>{if(R.value&&m.value===null&&(r.virtual.value?r.virtual.value.options.length>0:v.value.length>0)){if(r.virtual.value){let c=r.virtual.value.options.findIndex(b=>{var x;return!((x=r.virtual.value)!=null&&x.disabled(b))});if(c!==-1)return c}let s=v.value.findIndex(c=>!c.dataRef.disabled);if(s!==-1)return s}return m.value}),activationTrigger:S,optionsPropsRef:p,closeCombobox(){R.value=!1,!o.disabled&&t.value!==1&&(t.value=1,m.value=null)},openCombobox(){if(R.value=!0,!o.disabled&&t.value!==0){if(r.value.value){let s=r.calculateIndex(r.value.value);s!==-1&&(m.value=s)}t.value=0}},setActivationTrigger(s){S.value=s},goToOption(s,c,b){R.value=!1,A!==null&&cancelAnimationFrame(A),A=requestAnimationFrame(()=>{if(o.disabled||d.value&&!p.value.static&&t.value===1)return;if(r.virtual.value){m.value=s===$.Specific?c:pe({focus:s},{resolveItems:()=>r.virtual.value.options,resolveActiveIndex:()=>{var _,F;return(F=(_=r.activeOptionIndex.value)!=null?_:r.virtual.value.options.findIndex(K=>{var Y;return!((Y=r.virtual.value)!=null&&Y.disabled(K))}))!=null?F:null},resolveDisabled:_=>r.virtual.value.disabled(_),resolveId(){throw new Error("Function not implemented.")}}),S.value=b??2;return}let x=h();if(x.activeOptionIndex===null){let _=x.options.findIndex(F=>!F.dataRef.disabled);_!==-1&&(x.activeOptionIndex=_)}let T=s===$.Specific?c:pe({focus:s},{resolveItems:()=>x.options,resolveActiveIndex:()=>x.activeOptionIndex,resolveId:_=>_.id,resolveDisabled:_=>_.dataRef.disabled});m.value=T,S.value=b??2,v.value=x.options})},selectOption(s){let c=v.value.find(x=>x.id===s);if(!c)return;let{dataRef:b}=c;w(b.value)},selectActiveOption(){if(r.activeOptionIndex.value!==null){if(r.virtual.value)w(r.virtual.value.options[r.activeOptionIndex.value]);else{let{dataRef:s}=v.value[r.activeOptionIndex.value];w(s.value)}r.goToOption($.Specific,r.activeOptionIndex.value)}},registerOption(s,c){let b=_e({id:s,dataRef:c});if(r.virtual.value){v.value.push(b);return}f&&cancelAnimationFrame(f);let x=h(T=>(T.push(b),T));m.value===null&&r.isSelected(c.value.value)&&(x.activeOptionIndex=x.options.indexOf(b)),v.value=x.options,m.value=x.activeOptionIndex,S.value=2,x.options.some(T=>!I(T.dataRef.domRef))&&(f=requestAnimationFrame(()=>{let T=h();v.value=T.options,m.value=T.activeOptionIndex}))},unregisterOption(s,c){if(A!==null&&cancelAnimationFrame(A),c&&(R.value=!0),r.virtual.value){v.value=v.value.filter(x=>x.id!==s);return}let b=h(x=>{let T=x.findIndex(_=>_.id===s);return T!==-1&&x.splice(T,1),x});v.value=b.options,m.value=b.activeOptionIndex,S.value=2},isSelected(s){return q(M.value,{0:()=>r.compare(B(r.value.value),B(s)),1:()=>B(r.value.value).some(c=>r.compare(B(c),B(s)))})},isActive(s){return m.value===r.calculateIndex(s)}};je([a,l,d],()=>r.closeCombobox(),O(()=>t.value===0)),ge(Se,r),Ne(O(()=>q(t.value,{0:ne.Open,1:ne.Closed})));let y=O(()=>{var s;return(s=I(a))==null?void 0:s.closest("form")});return ue(()=>{W([y],()=>{if(!y.value||o.defaultValue===void 0)return;function s(){r.change(o.defaultValue)}return y.value.addEventListener("reset",s),()=>{var c;(c=y.value)==null||c.removeEventListener("reset",s)}},{immediate:!0})}),()=>{var s,c,b;let{name:x,disabled:T,form:_,...F}=o,K={open:t.value===0,disabled:T,activeIndex:r.activeOptionIndex.value,activeOption:r.activeOptionIndex.value===null?null:r.virtual.value?r.virtual.value.options[(s=r.activeOptionIndex.value)!=null?s:0]:(b=(c=r.options.value[r.activeOptionIndex.value])==null?void 0:c.dataRef.value)!=null?b:null,value:E.value};return le(xe,[...x!=null&&E.value!=null?Be({[x]:E.value}).map(([Y,Ce])=>le(We,Ke({features:Ue.Hidden,key:Y,as:"input",type:"hidden",hidden:!0,readOnly:!0,form:_,disabled:T,name:Y,value:Ce}))):[],X({theirProps:{...e,...de(F,["by","defaultValue","immediate","modelValue","multiple","nullable","onUpdate:modelValue","virtual"])},ourProps:{},slot:K,slots:u,attrs:e,name:"Combobox"})])}}}),Ot=H({name:"ComboboxButton",props:{as:{type:[Object,String],default:"button"},id:{type:String,default:null}},setup(o,{attrs:u,slots:e,expose:n}){var t;let i=(t=o.id)!=null?t:`headlessui-combobox-button-${ie()}`,a=J("ComboboxButton");n({el:a.buttonRef,$el:a.buttonRef});function l(v){a.disabled.value||(a.comboboxState.value===0?a.closeCombobox():(v.preventDefault(),a.openCombobox()),N(()=>{var m;return(m=I(a.inputRef))==null?void 0:m.focus({preventScroll:!0})}))}function d(v){switch(v.key){case V.ArrowDown:v.preventDefault(),v.stopPropagation(),a.comboboxState.value===1&&a.openCombobox(),N(()=>{var m;return(m=a.inputRef.value)==null?void 0:m.focus({preventScroll:!0})});return;case V.ArrowUp:v.preventDefault(),v.stopPropagation(),a.comboboxState.value===1&&(a.openCombobox(),N(()=>{a.value.value||a.goToOption($.Last)})),N(()=>{var m;return(m=a.inputRef.value)==null?void 0:m.focus({preventScroll:!0})});return;case V.Escape:if(a.comboboxState.value!==0)return;v.preventDefault(),a.optionsRef.value&&!a.optionsPropsRef.value.static&&v.stopPropagation(),a.closeCombobox(),N(()=>{var m;return(m=a.inputRef.value)==null?void 0:m.focus({preventScroll:!0})});return}}let p=Ze(O(()=>({as:o.as,type:u.type})),a.buttonRef);return()=>{var v,m;let S={open:a.comboboxState.value===0,disabled:a.disabled.value,value:a.value.value},{...R}=o,h={ref:a.buttonRef,id:i,type:p.value,tabindex:"-1","aria-haspopup":"listbox","aria-controls":(v=I(a.optionsRef))==null?void 0:v.id,"aria-expanded":a.comboboxState.value===0,"aria-labelledby":a.labelRef.value?[(m=I(a.labelRef))==null?void 0:m.id,i].join(" "):void 0,disabled:a.disabled.value===!0?!0:void 0,onKeydown:d,onClick:l};return X({ourProps:h,theirProps:R,slot:S,attrs:u,slots:e,name:"ComboboxButton"})}}}),yt=H({name:"ComboboxInput",props:{as:{type:[Object,String],default:"input"},static:{type:Boolean,default:!1},unmount:{type:Boolean,default:!0},displayValue:{type:Function},defaultValue:{type:String,default:void 0},id:{type:String,default:null}},emits:{change:o=>!0},setup(o,{emit:u,attrs:e,slots:n,expose:t}){var i;let a=(i=o.id)!=null?i:`headlessui-combobox-input-${ie()}`,l=J("ComboboxInput"),d=O(()=>qe(I(l.inputRef))),p={value:!1};t({el:l.inputRef,$el:l.inputRef});function v(){l.change(null);let f=I(l.optionsRef);f&&(f.scrollTop=0),l.goToOption($.Nothing)}let m=O(()=>{var f;let w=l.value.value;return I(l.inputRef)?typeof o.displayValue<"u"&&w!==void 0?(f=o.displayValue(w))!=null?f:"":typeof w=="string"?w:"":""});ue(()=>{W([m,l.comboboxState,d],([f,w],[C,r])=>{if(p.value)return;let y=I(l.inputRef);y&&((r===0&&w===1||f!==C)&&(y.value=f),requestAnimationFrame(()=>{var s;if(p.value||!y||((s=d.value)==null?void 0:s.activeElement)!==y)return;let{selectionStart:c,selectionEnd:b}=y;Math.abs((b??0)-(c??0))===0&&c===0&&y.setSelectionRange(y.value.length,y.value.length)}))},{immediate:!0}),W([l.comboboxState],([f],[w])=>{if(f===0&&w===1){if(p.value)return;let C=I(l.inputRef);if(!C)return;let r=C.value,{selectionStart:y,selectionEnd:s,selectionDirection:c}=C;C.value="",C.value=r,c!==null?C.setSelectionRange(y,s,c):C.setSelectionRange(y,s)}})});let S=z(!1);function R(){S.value=!0}function h(){re().nextFrame(()=>{S.value=!1})}let M=vt();function D(f){switch(p.value=!0,M(()=>{p.value=!1}),f.key){case V.Enter:if(p.value=!1,l.comboboxState.value!==0||S.value)return;if(f.preventDefault(),f.stopPropagation(),l.activeOptionIndex.value===null){l.closeCombobox();return}l.selectActiveOption(),l.mode.value===0&&l.closeCombobox();break;case V.ArrowDown:return p.value=!1,f.preventDefault(),f.stopPropagation(),q(l.comboboxState.value,{0:()=>l.goToOption($.Next),1:()=>l.openCombobox()});case V.ArrowUp:return p.value=!1,f.preventDefault(),f.stopPropagation(),q(l.comboboxState.value,{0:()=>l.goToOption($.Previous),1:()=>{l.openCombobox(),N(()=>{l.value.value||l.goToOption($.Last)})}});case V.Home:if(f.shiftKey)break;return p.value=!1,f.preventDefault(),f.stopPropagation(),l.goToOption($.First);case V.PageUp:return p.value=!1,f.preventDefault(),f.stopPropagation(),l.goToOption($.First);case V.End:if(f.shiftKey)break;return p.value=!1,f.preventDefault(),f.stopPropagation(),l.goToOption($.Last);case V.PageDown:return p.value=!1,f.preventDefault(),f.stopPropagation(),l.goToOption($.Last);case V.Escape:if(p.value=!1,l.comboboxState.value!==0)return;f.preventDefault(),l.optionsRef.value&&!l.optionsPropsRef.value.static&&f.stopPropagation(),l.nullable.value&&l.mode.value===0&&l.value.value===null&&v(),l.closeCombobox();break;case V.Tab:if(p.value=!1,l.comboboxState.value!==0)return;l.mode.value===0&&l.activationTrigger.value!==1&&l.selectActiveOption(),l.closeCombobox();break}}function P(f){u("change",f),l.nullable.value&&l.mode.value===0&&f.target.value===""&&v(),l.openCombobox()}function g(f){var w,C,r;let y=(w=f.relatedTarget)!=null?w:me.find(s=>s!==f.currentTarget);if(p.value=!1,!((C=I(l.optionsRef))!=null&&C.contains(y))&&!((r=I(l.buttonRef))!=null&&r.contains(y))&&l.comboboxState.value===0)return f.preventDefault(),l.mode.value===0&&(l.nullable.value&&l.value.value===null?v():l.activationTrigger.value!==1&&l.selectActiveOption()),l.closeCombobox()}function E(f){var w,C,r;let y=(w=f.relatedTarget)!=null?w:me.find(s=>s!==f.currentTarget);(C=I(l.buttonRef))!=null&&C.contains(y)||(r=I(l.optionsRef))!=null&&r.contains(y)||l.disabled.value||l.immediate.value&&l.comboboxState.value!==0&&(l.openCombobox(),re().nextFrame(()=>{l.setActivationTrigger(1)}))}let A=O(()=>{var f,w,C,r;return(r=(C=(w=o.defaultValue)!=null?w:l.defaultValue.value!==void 0?(f=o.displayValue)==null?void 0:f.call(o,l.defaultValue.value):null)!=null?C:l.defaultValue.value)!=null?r:""});return()=>{var f,w,C,r,y,s,c;let b={open:l.comboboxState.value===0},{displayValue:x,onChange:T,..._}=o,F={"aria-controls":(f=l.optionsRef.value)==null?void 0:f.id,"aria-expanded":l.comboboxState.value===0,"aria-activedescendant":l.activeOptionIndex.value===null?void 0:l.virtual.value?(w=l.options.value.find(K=>!l.virtual.value.disabled(K.dataRef.value)&&l.compare(K.dataRef.value,l.virtual.value.options[l.activeOptionIndex.value])))==null?void 0:w.id:(C=l.options.value[l.activeOptionIndex.value])==null?void 0:C.id,"aria-labelledby":(s=(r=I(l.labelRef))==null?void 0:r.id)!=null?s:(y=I(l.buttonRef))==null?void 0:y.id,"aria-autocomplete":"list",id:a,onCompositionstart:R,onCompositionend:h,onKeydown:D,onInput:P,onFocus:E,onBlur:g,role:"combobox",type:(c=e.type)!=null?c:"text",tabIndex:0,ref:l.inputRef,defaultValue:A.value,disabled:l.disabled.value===!0?!0:void 0};return X({ourProps:F,theirProps:_,slot:b,attrs:e,slots:n,features:ae.RenderStrategy|ae.Static,name:"ComboboxInput"})}}}),It=H({name:"ComboboxOptions",props:{as:{type:[Object,String],default:"ul"},static:{type:Boolean,default:!1},unmount:{type:Boolean,default:!0},hold:{type:[Boolean],default:!1}},setup(o,{attrs:u,slots:e,expose:n}){let t=J("ComboboxOptions"),i=`headlessui-combobox-options-${ie()}`;n({el:t.optionsRef,$el:t.optionsRef}),oe(()=>{t.optionsPropsRef.value.static=o.static}),oe(()=>{t.optionsPropsRef.value.hold=o.hold});let a=He(),l=O(()=>a!==null?(a.value&ne.Open)===ne.Open:t.comboboxState.value===0);Ge({container:O(()=>I(t.optionsRef)),enabled:O(()=>t.comboboxState.value===0),accept(p){return p.getAttribute("role")==="option"?NodeFilter.FILTER_REJECT:p.hasAttribute("role")?NodeFilter.FILTER_SKIP:NodeFilter.FILTER_ACCEPT},walk(p){p.setAttribute("role","none")}});function d(p){p.preventDefault()}return()=>{var p,v,m;let S={open:t.comboboxState.value===0},R={"aria-labelledby":(m=(p=I(t.labelRef))==null?void 0:p.id)!=null?m:(v=I(t.buttonRef))==null?void 0:v.id,id:i,ref:t.optionsRef,role:"listbox","aria-multiselectable":t.mode.value===1?!0:void 0,onMousedown:d},h=de(o,["hold"]);return X({ourProps:R,theirProps:h,slot:S,attrs:u,slots:t.virtual.value&&t.comboboxState.value===0?{...e,default:()=>[le(gt,{},e.default)]}:e,features:ae.RenderStrategy|ae.Static,visible:l.value,name:"ComboboxOptions"})}}}),St=H({name:"ComboboxOption",props:{as:{type:[Object,String],default:"li"},value:{type:[Object,String,Number,Boolean]},disabled:{type:Boolean,default:!1},order:{type:[Number],default:null}},setup(o,{slots:u,attrs:e,expose:n}){let t=J("ComboboxOption"),i=`headlessui-combobox-option-${ie()}`,a=z(null),l=O(()=>o.disabled);n({el:a,$el:a});let d=O(()=>{var g;return t.virtual.value?t.activeOptionIndex.value===t.calculateIndex(o.value):t.activeOptionIndex.value===null?!1:((g=t.options.value[t.activeOptionIndex.value])==null?void 0:g.id)===i}),p=O(()=>t.isSelected(o.value)),v=Oe(we,null),m=O(()=>({disabled:o.disabled,value:o.value,domRef:a,order:O(()=>o.order)}));ue(()=>t.registerOption(i,m)),be(()=>t.unregisterOption(i,d.value)),oe(()=>{let g=I(a);g&&(v==null||v.value.measureElement(g))}),oe(()=>{t.comboboxState.value===0&&d.value&&(t.virtual.value||t.activationTrigger.value!==0&&N(()=>{var g,E;return(E=(g=I(a))==null?void 0:g.scrollIntoView)==null?void 0:E.call(g,{block:"nearest"})}))});function S(g){g.preventDefault(),g.button===Ie.Left&&(l.value||(t.selectOption(i),Ye()||requestAnimationFrame(()=>{var E;return(E=I(t.inputRef))==null?void 0:E.focus({preventScroll:!0})}),t.mode.value===0&&t.closeCombobox()))}function R(){var g;if(o.disabled||(g=t.virtual.value)!=null&&g.disabled(o.value))return t.goToOption($.Nothing);let E=t.calculateIndex(o.value);t.goToOption($.Specific,E)}let h=Le();function M(g){h.update(g)}function D(g){var E;if(!h.wasMoved(g)||o.disabled||(E=t.virtual.value)!=null&&E.disabled(o.value)||d.value)return;let A=t.calculateIndex(o.value);t.goToOption($.Specific,A,0)}function P(g){var E;h.wasMoved(g)&&(o.disabled||(E=t.virtual.value)!=null&&E.disabled(o.value)||d.value&&(t.optionsPropsRef.value.hold||t.goToOption($.Nothing)))}return()=>{let{disabled:g}=o,E={active:d.value,selected:p.value,disabled:g},A={id:i,ref:a,role:"option",tabIndex:g===!0?void 0:-1,"aria-disabled":g===!0?!0:void 0,"aria-selected":p.value,disabled:void 0,onMousedown:S,onFocus:R,onPointerenter:M,onMouseenter:M,onPointermove:D,onMousemove:D,onPointerleave:P,onMouseleave:P},f=de(o,["order","value"]);return X({ourProps:A,theirProps:f,slot:E,attrs:e,slots:u,name:"ComboboxOption"})}}});const wt={},Ct={xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 256 256"},Rt=j("path",{d:"M228.24,76.24l-128,128a6,6,0,0,1-8.48,0l-56-56a6,6,0,0,1,8.48-8.48L96,191.51,219.76,67.76a6,6,0,0,1,8.48,8.48Z"},null,-1),Et=[Rt];function Tt(o,u){return L(),Q("svg",Ct,Et)}const _t=ze(wt,[["render",Tt]]),Mt={class:"relative w-[400px]"},zt={key:0,class:"flex"},$t={key:1},Wt={__name:"ModelCombobox",props:{model:{type:String,default:"iems"}},async setup(o){let u,e;const n=fe("$DT3DmYpVM0"),t=fe("$5fySHvqEsm");z(!1);const i=o,{data:a}=([u,e]=$e(()=>Ve(i.model,()=>Ae(i.model).find(),{watch:[()=>i.model]})),u=await u,e(),u),l=z(""),d=z(null),p=O(()=>l.value===""?a.value:a.value.filter(v=>(v.model?v.model.toLowerCase().includes(l.value.toLowerCase()):v._path.toLowerCase().includes(l.value.toLowerCase()))||(v.brand?v.brand.toLowerCase().includes(l.value.toLowerCase()):v._path.split("/")[3].toLowerCase().includes(l.value.toLowerCase()))));return(v,m)=>{const S=Re,R=_t;return L(),ve(k(xt),{as:"div",modelValue:k(d),"onUpdate:modelValue":m[1]||(m[1]=h=>ke(d)?d.value=h:null)},{default:ee(()=>[j("div",Mt,[Z(k(yt),{id:k(n),class:"w-full rounded-md border-0 bg-white py-2.5 pl-4 pr-12 dark:bg-gray-800 shadow-sm focus:outline-none ring-1 ring-inset ring-gray-300 dark:ring-gray-600 sm:leading-6",onChange:m[0]||(m[0]=h=>l.value=h.target.value),"display-value":h=>h!=null&&h.model?h==null?void 0:h.model:h._dir+" "+h._path.split("/")[3]},null,8,["id","display-value"]),Z(k(Ot),{id:k(t),class:"absolute inset-y-0 right-0 flex items-center rounded-r-md px-2 focus:outline-none"},{default:ee(()=>[Z(S,{name:"ph:caret-down",class:"text-gray-400 mr-1","aria-hidden":"true"})]),_:1},8,["id"]),Z(k(It),{class:"absolute z-10 mt-1 max-h-[510px] w-full overflow-auto rounded-md bg-white dark:bg-gray-700 py-1 text-base shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none sm:text-sm"},{default:ee(()=>[(L(!0),Q(xe,null,De(k(p),h=>(L(),ve(k(St),{key:h.model,value:h,as:"template"},{default:ee(({active:M,selected:D})=>[j("li",{class:U(["relative cursor-default select-none py-2 pl-3 pr-9",M?"bg-indigo-600 text-white":""])},[h.model?(L(),Q("div",zt,[j("span",{class:U(["truncate capitalize",D&&"font-semibold"])},te(h.model),3),j("span",{class:U(["ml-2 truncate capitalize text-gray-400",M?"text-indigo-200":"text-gray-500"])},te(h.brand),3)])):(L(),Q("div",$t,[j("span",{class:U(["truncate capitalize",D&&"font-semibold"])},te(h._path.split("/")[3]),3),j("span",{class:U(["ml-2 truncate capitalize text-gray-400",M?"text-indigo-200":"text-gray-500"])},te(h._dir),3)])),D?(L(),Q("span",{key:2,class:U(["absolute inset-y-0 right-0 flex items-center pr-4",M?"text-white":"text-indigo-600"])},[Z(R,{class:"h-5 w-5","aria-hidden":"true"})],2)):Pe("",!0)],2)]),_:2},1032,["value"]))),128))]),_:1})])]),_:1},8,["modelValue"])}}};export{Wt as _};
