import{_ as I}from"./BD8WLPty.js";import{_ as D}from"./rFhTn0FA.js";import{_ as ee}from"./Be1HZvcP.js";import{H as se,A as S,r as d,J as te,E as ae,K as M,c as r,e as c,f as e,U as N,Q as P,V as T,B as l,n as le,g as oe,D as ie,h as n,w as g,k as C,F as q,C as w,t as B,S as E}from"./YKJGr53e.js";import{u as ne}from"./s3-Ad5Vt.js";import{u as H}from"./Bkkvs3X8.js";import{q as h}from"./CHZsaEkH.js";import"./srjAdVVy.js";import"./DxjlTc0-.js";import"./BQkc-AXV.js";import"./j4F_aXRO.js";import"./KtzzS9P3.js";import"./CTAIbY_z.js";import"./Be8J6HL0.js";import"./CBpMDLrE.js";import"./BboEKukF.js";import"./BIqF7sE6.js";import"./BGcilHqP.js";import"./CNb5zuOU.js";const re={class:"flex flex-col flex-grow dark:bg-gray-800 mb-24"},de={class:"space-y-10 max-w-7xl mx-auto lg:px-8 mt-16 px-4"},ce={class:"grid grid-cols-1 gap-x-8 gap-y-8 md:grid-cols-3"},ue=e("div",{class:"px-4 sm:px-0"},[e("h2",{class:"text-base font-semibold leading-7 text-gray-900"},"Profile"),e("p",{class:"mt-1 text-sm leading-6 text-gray-600"},"This information will be displayed publicly so be careful what you share.")],-1),me={class:"px-4 py-6 sm:p-8"},pe={class:"grid grid-cols-1 gap-x-6 gap-y-8 sm:grid-cols-6"},_e={class:"sm:col-span-full"},fe=e("label",{for:"name",class:"block text-sm font-semibold leading-6 text-gray-700 mb-1"},"Username",-1),ve={key:0,class:"text-xs mt-1"},ge={class:"sm:col-span-full"},he=e("label",{for:"name",class:"block text-sm font-semibold leading-6 text-gray-700 mb-1"},"Name",-1),xe={class:"sm:col-span-full"},be=e("label",{for:"name",class:"block text-sm font-semibold leading-6 text-gray-700 mb-1"},"Email",-1),ye=["value"],ke={class:"col-span-full"},Ce=e("label",{class:"block text-sm font-semibold leading-6 text-gray-700 mb-1"},"Avatar",-1),Ve={class:"mt-2 flex items-center gap-x-3"},Ae={key:0,class:"w-14 h-14"},Se=["src"],Ue=e("button",{type:"button",class:"rounded-md bg-white px-2.5 py-1.5 text-sm font-semibold text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50"},"Change",-1),Oe={class:"flex items-center justify-end gap-x-6 border-t border-gray-900/10 px-4 py-4 sm:px-8"},$e={class:"grid grid-cols-1 gap-x-8 gap-y-8 md:grid-cols-3"},qe=e("div",{class:"px-4 sm:px-0"},[e("h2",{class:"text-base font-semibold leading-7 text-gray-900"},"Owned audio gear"),e("p",{class:"mt-1 text-sm leading-6 text-gray-600"},"Share with us, what audio devices you have or currently using")],-1),we={class:"px-4 py-6 sm:p-8"},Be={class:"grid grid-cols-1 gap-x-6 gap-y-8 sm:grid-cols-6"},Ee={class:"sm:col-span-full"},Fe=e("label",{for:"name",class:"block text-sm font-semibold leading-6 text-gray-700 mb-1"},"IEMs",-1),Me={class:"mb-3"},Ne={class:"flex items-center gap-2"},Pe={class:"flex items-center gap-2"},Te={class:"sm:col-span-full"},He=e("label",{for:"name",class:"block text-sm font-semibold leading-6 text-gray-700 mb-1"},"DAP(s)",-1),je={class:"mb-3"},ze={class:"flex items-center gap-2"},Je={class:"flex items-center gap-2"},Ke={class:"sm:col-span-full"},Le=e("label",{for:"name",class:"block text-sm font-semibold leading-6 text-gray-700 mb-1"},"DAC(s)",-1),Re={class:"mb-3"},Ge={class:"flex items-center gap-2"},Qe={class:"flex items-center gap-2"},We=e("div",{class:"col-span-full"},[e("label",{class:"block text-sm font-semibold leading-6 text-gray-700 mb-1"},"Other, tips, cable, etc"),e("div",{class:"mt-2 flex items-center gap-x-3"},[e("textarea",{class:"w-full border rounded p-2",rows:"4"})])],-1),Xe={class:"flex items-center justify-end gap-x-6 border-t border-gray-900/10 px-4 py-4 sm:px-8"},vs={__name:"settings",async setup(Ye){let i,u;const m=ne(),U=se(),{data:o}=([i,u]=S(()=>H("/api/users/"+m.value.id,"$Gs6tTTHIKz")),i=await i,u(),i),V=d(),j=te(()=>V.value?V.value:m.avatar?m.avatar:!1),z=t=>{V.value=t.url,t.formData.append("disk","local"),t.formData.append("inline",!0),auth.value.user.upload=t.formData},p=d(!1),J=async()=>{if(p.value=!0,V.value){const{data:t}=await H("upload",{method:"POST",body:auth.value.user.upload},"$r3HLd6bJvb");auth.value.user.avatarFileName=t}await U.from("profiles").update({username:o.value.username,name:o.value.name}).eq("id",m.value.id),p.value=!1},A=d(!0);ae(()=>o.value.username,async t=>{const{data:a}=await U.from("profiles").select().neq("id",o.value.id).eq("username",t);A.value=!a.length});const _=d([]);if(o.value.iems&&o.value.iems.length)for(const t of o.value.iems){const a=([i,u]=S(()=>h(t).findOne()),i=await i,u(),i);_.value.push(a)}const f=d([]);if(o.value.daps&&o.value.daps.length)for(const t of o.value.daps){const a=([i,u]=S(()=>h(t).findOne()),i=await i,u(),i);f.value.push(a)}const v=d([]);if(o.value.dacs&&o.value.dacs.length)for(const t of o.value.dacs){const a=([i,u]=S(()=>h(t).findOne()),i=await i,u(),i);v.value.push(a)}const x=d(),K=async()=>{_.value.push(await h(x.value._path).findOne())},L=t=>{_.value.splice(_.value.findIndex(a=>a._path==t._path),1)},b=d(),R=async()=>{f.value.push(await h(b.value._path).findOne())},G=t=>{f.value.splice(f.value.findIndex(a=>a._path==t._path),1)},y=d(),Q=async()=>{v.value.push(await h(y.value._path).findOne())},W=t=>{v.value.splice(v.value.findIndex(a=>a._path==t._path),1)},X=async()=>{p.value=!0,await U.from("profiles").update({iems:_.value.map(t=>t._path),daps:f.value.map(t=>t._path),dacs:v.value.map(t=>t._path),name:o.value.name}).eq("id",m.value.id),p.value=!1};return(t,a)=>{const Y=M("IconsUser"),Z=I,k=D,O=M("IconsCross"),$=ee;return r(),c("div",re,[e("div",de,[e("div",ce,[ue,e("form",{onSubmit:N(J,["prevent"]),class:"bg-white shadow-sm ring-1 ring-gray-900/5 sm:rounded-xl md:col-span-2"},[e("div",me,[e("div",pe,[e("div",_e,[fe,P(e("input",{type:"text",name:"username",id:"name",class:le(["border rounded px-4 py-2 w-full",[l(A)?"":"bg-red-200"]]),"onUpdate:modelValue":a[0]||(a[0]=s=>l(o).username=s)},null,2),[[T,l(o).username]]),l(A)?oe("",!0):(r(),c("div",ve,"Username already taken"))]),e("div",ge,[he,P(e("input",{type:"text",name:"name",id:"username",class:"border rounded px-4 py-2 w-full","onUpdate:modelValue":a[1]||(a[1]=s=>l(o).name=s)},null,512),[[T,l(o).name]])]),e("div",xe,[be,e("input",{type:"text",name:"email",id:"email",class:"border rounded px-4 py-2 w-full",value:l(m).email,disabled:!0},null,8,ye)]),e("div",ke,[Ce,e("div",Ve,[l(o).avatar?(r(),c("div",Ae,[e("img",{src:l(j),class:"rounded-full max-h-full max-w-full"},null,8,Se)])):(r(),ie(Y,{key:1,class:"w-8 h-8","aria-hidden":"true"})),n(Z,{onCropped:z,aspectRatio:1},{default:g(()=>[Ue]),_:1})])])])]),e("div",Oe,[n(k,{disabled:!l(A),color:"green",loading:l(p),class:"disabled:opacity-50"},{default:g(()=>[C("Save")]),_:1},8,["disabled","loading"])])],32)]),e("div",$e,[qe,e("form",{onSubmit:N(X,["prevent"]),class:"bg-white shadow-sm ring-1 ring-gray-900/5 sm:rounded-xl md:col-span-2"},[e("div",we,[e("div",Be,[e("div",Ee,[Fe,e("ul",Me,[(r(!0),c(q,null,w(l(_),s=>(r(),c("li",Ne,[e("div",null,B(s!=null&&s.model?s==null?void 0:s.model:s._dir+" "+s._path.split("/")[3]),1),n(O,{class:"w-4 h-4 text-red-600 cursor-pointer",onClick:F=>L(s)},null,8,["onClick"])]))),256))]),e("div",Pe,[n($,{modelValue:l(x),"onUpdate:modelValue":a[2]||(a[2]=s=>E(x)?x.value=s:null),model:"iem"},null,8,["modelValue"]),n(k,{color:"blue",onClick:K,disabled:!l(x)},{default:g(()=>[C("Add")]),_:1},8,["disabled"])])]),e("div",Te,[He,e("ul",je,[(r(!0),c(q,null,w(l(f),s=>(r(),c("li",ze,[e("div",null,B(s!=null&&s.model?s==null?void 0:s.model:s._dir+" "+s._path.split("/")[3]),1),n(O,{class:"w-4 h-4 text-red-600 cursor-pointer",onClick:F=>G(s)},null,8,["onClick"])]))),256))]),e("div",Je,[n($,{modelValue:l(b),"onUpdate:modelValue":a[3]||(a[3]=s=>E(b)?b.value=s:null),model:"dap"},null,8,["modelValue"]),n(k,{color:"blue",onClick:R,disabled:!l(b)},{default:g(()=>[C("Add")]),_:1},8,["disabled"])])]),e("div",Ke,[Le,e("ul",Re,[(r(!0),c(q,null,w(l(v),s=>(r(),c("li",Ge,[e("div",null,B(s!=null&&s.model?s==null?void 0:s.model:s._dir+" "+s._path.split("/")[3]),1),n(O,{class:"w-4 h-4 text-red-600 cursor-pointer",onClick:F=>W(s)},null,8,["onClick"])]))),256))]),e("div",Qe,[n($,{modelValue:l(y),"onUpdate:modelValue":a[4]||(a[4]=s=>E(y)?y.value=s:null),model:"dac"},null,8,["modelValue"]),n(k,{color:"blue",onClick:Q,disabled:!l(y)},{default:g(()=>[C("Add")]),_:1},8,["disabled"])])]),We])]),e("div",Xe,[n(k,{color:"green",type:"submit",loading:l(p),class:"disabled:opacity-50"},{default:g(()=>[C("Save")]),_:1},8,["loading"])])],32)])])])}}};export{vs as default};
